/* tnSplit.js v1.04 rev.2 (c) 2021, phpkobo.com. Free to use under the MIT license.
http://jpn.phpkobo.com/tnsplit-js */
!function(){"use strict";var e={now:function(){return window.performance&&window.performance.now?performance.now():-1},start:function(){this.t0=this.now()},stop:function(){var e=this.now();return e<0?e:e-this.t0},toSec:function(e){return(e/1e3).toFixed(3)}};function t(e,t){return Math.random()*(t-e)+e}function n(e){for(var t="",n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",s=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*s));return t}function s(e){return Array.isArray(e)?e:[e]}var i={setup:function(e){this.tagName="tagName"in e?e.tagName:"x-x",this.excludeClass=s("excludeClass"in e?e.excludeClass:["tns-exclude"]),this.excludeTag=s("excludeTag"in e?e.excludeTag:["script","style","title"]).map(function(e){return e.toLowerCase()}),this.idPrefix="idPrefix"in e&&e.idPrefix.length?e.idPrefix:"tnsid-",this.idPrefixLen=Math.max(0,"idPrefixLen"in e?e.idPrefixLen:10),this.removeComment="removeComment"in e?e.removeComment:1,this.stats={n_root:0,n_text:0,n_char:0},"runcnt"in this||(this.runcnt=0),0==this.runcnt&&this.setup_once(),this.runcnt++},setup_once:function(){this.cls_apply="tns-apply",this.ele_style=document.createElement("style"),document.head.appendChild(this.ele_style),this.sheet=this.ele_style.sheet,this.done=new WeakMap,this.re_wspace=new RegExp("^\\s*$")},makeId:function(){var e,t=0;do{e=this.idPrefix+n(this.idPrefixLen+t),t++}while(document.getElementById(e));return e},insertStyleRule:function(e,t,n){"\n"==n&&(n="\\a"),'"'==n&&(n='\\"');var s="#"+e+"::"+t+"{"+('content:"'+n+'";')+"}";this.sheet.insertRule(s,0)},makeStyleRules:function(e,t,n){t&&(this.insertStyleRule(e,"before",t),this.stats.n_char+=t.length),n&&(this.insertStyleRule(e,"after",n),this.stats.n_char+=n.length)},makeNode:function(e,t){var n=this.makeId();this.makeStyleRules(n,e,t);var s=document.createElement(this.tagName);return s.id=n,s},convertStr:function(e){var n=null,s=null,i=e.length;i&&(n=e.shift(),--i&&(s=e.pop(),i--));for(var r=this.makeNode(n,s),o=e.length+1;e.length>0;){var a=Math.min(e.length,t(1,o)),l=e.slice(0,a);e=e.slice(a),r.appendChild(this.convertStr(l))}return r},processTextNode:function(e){var t=e.nodeValue;t&&!this.re_wspace.test(t)&&(e.replaceWith(this.convertStr(function(e){for(var t=[],n="",s=0;s<e.length;s++){var i=e.charCodeAt(s);55296<=i&&i<=56319||56320<=i&&i<=57343?n+=e[s]:(n&&(t.push(n),n=""),t.push(e[s]))}return n&&t.push(n),t}(t))),this.stats.n_text++)},shouldGo:function(e){if(this.done.has(e))return!1;for(var t=this.excludeClass,n=0;n<t.length;n++)if(e.classList.contains(t[n]))return!1;return-1==this.excludeTag.indexOf(e.tagName.toLowerCase())},collectTextNodes_x:function(e,t){for(var n=0;n<t.childNodes.length;n++){var s=t.childNodes[n],i=s.nodeType;i==Node.ELEMENT_NODE?this.shouldGo(s)&&this.collectTextNodes_x(e,s):i!=Node.TEXT_NODE&&i!=Node.COMMENT_NODE||e.ls.push(s)}},collectTextNodes:function(e){var t={ls:[]};return this.collectTextNodes_x(t,e),t.ls},processNodes:function(e){for(var t=0;t<e.length;t++){var n=e[t];if(this.shouldGo(n)){this.stats.n_root++;for(var s=this.collectTextNodes(n),i=0;i<s.length;i++){var r=s[i];r.nodeType==Node.COMMENT_NODE?this.removeComment&&r.remove():this.processTextNode(r)}this.done.set(n,1)}}},run:function(t){t=void 0===t?{}:t,this.setup(t),e.start();var n=function(e,t){var n=[];if(e||(e=t),Array.isArray(e))n=e;else if("string"==typeof e){var s=document.querySelectorAll(e);n=[].slice.call(s)}else e instanceof HTMLElement?n.push(e):(e instanceof HTMLCollection||"NodeList"==e.constructor.name)&&(n=[].slice.call(e));return n}(t.selector,"."+this.cls_apply);return this.processNodes(n),this.stats.elapsed=e.stop(),this.stats}};window.tnSplit=i}();
